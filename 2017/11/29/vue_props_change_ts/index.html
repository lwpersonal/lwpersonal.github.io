<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">



  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.ico?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Vue," />










<meta name="description" content="制作组件的时候大部分情况需要在子组件内部改变父组件的数据，但是由于vue的限制，在子组件改变父组件的state会报错，本文介绍如何利用v-model实现父子组件的数据双向绑定。如需查看常规 Vue 环境的教程，移步 =&amp;gt; vue如何像Element那样封装组件  本文环境  vue2(2.5+) vue-class-component  vue-property-decorator   大致">
<meta name="keywords" content="Vue">
<meta property="og:type" content="article">
<meta property="og:title" content="Vue2实现子组件改变父子组件的数据(TS版)">
<meta property="og:url" content="https://lwpersonal.cn/2017/11/29/vue_props_change_ts/index.html">
<meta property="og:site_name" content="安冉">
<meta property="og:description" content="制作组件的时候大部分情况需要在子组件内部改变父组件的数据，但是由于vue的限制，在子组件改变父组件的state会报错，本文介绍如何利用v-model实现父子组件的数据双向绑定。如需查看常规 Vue 环境的教程，移步 =&amp;gt; vue如何像Element那样封装组件  本文环境  vue2(2.5+) vue-class-component  vue-property-decorator   大致">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2018-10-29T02:15:51.311Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Vue2实现子组件改变父子组件的数据(TS版)">
<meta name="twitter:description" content="制作组件的时候大部分情况需要在子组件内部改变父组件的数据，但是由于vue的限制，在子组件改变父组件的state会报错，本文介绍如何利用v-model实现父子组件的数据双向绑定。如需查看常规 Vue 环境的教程，移步 =&amp;gt; vue如何像Element那样封装组件  本文环境  vue2(2.5+) vue-class-component  vue-property-decorator   大致">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://lwpersonal.cn/2017/11/29/vue_props_change_ts/"/>





  <title>Vue2实现子组件改变父子组件的数据(TS版) | 安冉</title>
  








  <style>
.github-corner:hover .octo-arm {
  animation:octocat-wave 560ms ease-in-out
}
@keyframes octocat-wave {
  0%,100% { transform:rotate(0)}
  20%,60% { transform:rotate(-25deg) }
  40%,80% { transform:rotate(10deg) }
}
@media (max-width:500px) {
  .github-corner:hover .octo-arm {
    animation:none
  }
  .github-corner .octo-arm {
    animation:octocat-wave 560ms ease-in-out
  }
}
</style>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>
    <a href="https://github.com/lwpersonal" class="github-corner" aria-label="View source on Github">
      <svg width="92" height="92" viewBox="0 0 250 250" style="fill:#151513;color:#fff;position:absolute;top:0;border:0;right:0" aria-hidden="true">
        <path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path>
        <path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path>
        <path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path>
      </svg>
    </a>
    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">安冉</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-首页">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-文章">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            文章
          </a>
        </li>
      
        
        <li class="menu-item menu-item-分类">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-关于我">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于我
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://lwpersonal.cn/2017/11/29/vue_props_change_ts/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="安冉">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="安冉">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Vue2实现子组件改变父子组件的数据(TS版)</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-11-29T13:37:04+08:00">
                2017-11-29
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Web/" itemprop="url" rel="index">
                    <span itemprop="name">Web</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-comment-o"></i>
              </span>
              
                <a href="/2017/11/29/vue_props_change_ts/#SOHUCS" itemprop="discussionUrl">
                  <span id="changyan_count_unit" class="post-comments-count hc-comment-count" data-xid="2017/11/29/vue_props_change_ts/" itemprop="commentsCount"></span>
                </a>
              
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  1.4k
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  7
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>制作组件的时候大部分情况需要在子组件内部改变父组件的数据，但是由于vue的限制，在子组件改变父组件的state会报错，本文介绍如何利用v-model实现父子组件的数据双向绑定。<br>如需查看常规 Vue 环境的教程，移步 =&gt; <a href="https://blog.csdn.net/qq_25243451/article/details/78934147" target="_blank" rel="noopener">vue如何像Element那样封装组件</a></p>
<blockquote>
<p>本文环境</p>
<ul>
<li>vue2(2.5+)</li>
<li>vue-class-component </li>
<li>vue-property-decorator</li>
</ul>
</blockquote>
<p>大致思路是用input的value承载父组件的数据，然后使用v-model实现双向绑定数据。</p>
<p>首先把父组件声传入的值声明为prop</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// vue-class-component 写法</span><br><span class="line">@Component(&#123;</span><br><span class="line">  model: &#123;</span><br><span class="line">    prop: &apos;val&apos;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">export default class Slidr extends Vue &#123;</span><br><span class="line">  // ...</span><br><span class="line">  @Prop()</span><br><span class="line">  val: number</span><br><span class="line">  // ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后在子组件添加一个input标签，然后将props绑定上去。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// 将val绑定在input的value上，并给input事件添加函数</span><br><span class="line">&lt;input style=&quot;display: none;&quot;</span><br><span class="line">  :value=&quot;val&quot;</span><br><span class="line">  @input=&quot;changeVal&quot;/&gt;</span><br></pre></td></tr></table></figure>
<p>然后要改变父组件绑定的值的时候，用自定义事件去改变</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// 当input的值改变时触发</span><br><span class="line">@Emit(&apos;input&apos;)</span><br><span class="line">  changeVal(val: number) &#123; &#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 要改变父组件的值时使用自定义事件函数，这样不会报错</span><br><span class="line">this.changeVal(5)</span><br></pre></td></tr></table></figure>
<p>还可以封装当值改变时的change事件，绑定在父组件上就可在val改变时触发</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// 自定义事件change</span><br><span class="line">@Emit(&apos;change&apos;)</span><br><span class="line">  outVal(val: number) &#123; &#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// 改写事件触发时执行的函数</span><br><span class="line">@Emit(&apos;input&apos;)</span><br><span class="line">  changeVal(val: number) &#123; this.outVal(val) &#125;</span><br></pre></td></tr></table></figure>
<p>然后就可以自己封装组件了</p>
<hr>
<p>下面是一个数据双向绑定的slider组件，可以参考一下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">&lt;section class=&quot;slider-box&quot;</span><br><span class="line">ref=&quot;slider&quot;</span><br><span class="line">:style=&quot;&#123;</span><br><span class="line">  width: wid,</span><br><span class="line">  opacity: disabled ? 0.5 : 1&#125;&quot;&gt;</span><br><span class="line"></span><br><span class="line">  &lt;div class=&quot;slider-line&quot;</span><br><span class="line">  ref=&quot;line&quot;</span><br><span class="line">  :style=&quot;lineSty&quot;&gt;&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">  &lt;div class=&quot;slider-line_choose&quot;</span><br><span class="line">  :style=&quot;lineChooseSty&quot;&gt;&lt;/div&gt;</span><br><span class="line">  </span><br><span class="line">  &lt;transition name=&quot;tag&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;tag&quot;</span><br><span class="line">    v-if=&quot;showTag &amp;&amp; isShowTag&quot;</span><br><span class="line">    :style=&quot;tagStyle&quot;&gt;&#123;&#123;tagPrompt || val&#125;&#125;&lt;/div&gt;</span><br><span class="line">  &lt;/transition&gt;</span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">  &lt;div</span><br><span class="line">  class=&quot;slider-btn&quot;</span><br><span class="line">  @touchstart=&quot;touchStart&quot;</span><br><span class="line">  @touchend=&quot;touchEnd&quot;</span><br><span class="line">  :class=&quot;&#123;</span><br><span class="line">    enter: isTouch,</span><br><span class="line">    out: !isTouch</span><br><span class="line">  &#125;&quot;</span><br><span class="line">  :style=&quot;[&#123;</span><br><span class="line">    borderColor: chooseColor&#125;,</span><br><span class="line">    btnPosit]&quot;&gt;&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!-- 使用input做到prop数据的双向绑定，在子组件改变父组件传入的prop的值不报错 --&gt;</span><br><span class="line">  &lt;input class=&quot;slider-val&quot;</span><br><span class="line">  :value=&quot;val&quot;</span><br><span class="line">  @input=&quot;changeVal&quot;/&gt;</span><br><span class="line">&lt;/section&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script lang=&quot;ts&quot;&gt;</span><br><span class="line">import Vue from &apos;vue&apos;</span><br><span class="line">import Component from &apos;vue-class-component&apos;</span><br><span class="line">import &#123; Prop, Emit &#125; from &apos;vue-property-decorator&apos;</span><br><span class="line">import &#123; throttle &#125; from &apos;lodash&apos;</span><br><span class="line">import $ from &apos;jquery&apos;</span><br><span class="line"></span><br><span class="line">@Component(&#123;</span><br><span class="line">  components: &#123;</span><br><span class="line">  &#125;,</span><br><span class="line">  model: &#123;</span><br><span class="line">    prop: &apos;val&apos;</span><br><span class="line">  &#125;,</span><br><span class="line">  filters: &#123;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">export default class Slidr extends Vue &#123;</span><br><span class="line">  isTouch: boolean = false // 是否触摸选中</span><br><span class="line">  onTouch :any = throttle(this.onTouchFn, 50) // 节流触摸事件</span><br><span class="line">  showTag: boolean = false</span><br><span class="line">  startValue: number = 0 // 检测触摸开始和结束的值是否一样</span><br><span class="line">  sliderInfo: any = &#123;</span><br><span class="line">    wid: 0, // slider的长度</span><br><span class="line">    hei: 0, // line的高度</span><br><span class="line">    left: 0, // slider在文档中的位置</span><br><span class="line">    right: 0, // slider在文档中的位置</span><br><span class="line">  &#125;</span><br><span class="line">  @Prop(&#123;default: 2&#125;)</span><br><span class="line">  digit: number // 数据精度，小数点后几位</span><br><span class="line">  @Prop(&#123;default: &apos;100%&apos;&#125;)</span><br><span class="line">  wid: String // slider长度</span><br><span class="line">  @Prop(&#123;default: &apos;2px&apos;&#125;)</span><br><span class="line">  hei: String // slider高度</span><br><span class="line">  @Prop(&#123;default: &apos;rgba(223,228,237,1)&apos;&#125;)</span><br><span class="line">  color: String // 未选中line背景色</span><br><span class="line">  @Prop(&#123;default: &apos;rgba(40,164,186,1)&apos;&#125;)</span><br><span class="line">  chooseColor: String</span><br><span class="line">  @Prop()</span><br><span class="line">  val: number // btn所在位置的值，用v-modal绑定</span><br><span class="line">  @Prop(&#123;default: 0&#125;)</span><br><span class="line">  minVal: number</span><br><span class="line">  @Prop(&#123;default: 1&#125;)</span><br><span class="line">  maxVal: number</span><br><span class="line">  @Prop(&#123;default: () =&gt; &#123; return&#123;backgroundColor:&apos;rgba(0,0,0,0.8)&apos;&#125;&#125;&#125;)</span><br><span class="line">  tagStyle: String // tag背景色</span><br><span class="line">  @Prop(&#123;default: false&#125;)</span><br><span class="line">  tagPrompt: any // tag显示内容</span><br><span class="line">  @Prop(&#123;default: true&#125;)</span><br><span class="line">  isShowTag: Boolean</span><br><span class="line">  @Prop(&#123;default: false&#125;)</span><br><span class="line">  disabled: Boolean // 是否禁用</span><br><span class="line">  @Emit(&apos;input&apos;)</span><br><span class="line">  changeVal(val: number) &#123; this.outVal(val) &#125;</span><br><span class="line">  @Emit(&apos;change&apos;)</span><br><span class="line">  outVal(val: number) &#123; &#125;</span><br><span class="line">  @Emit(&apos;changeEnd&apos;) // 结束事件返回两个参数，结束时的值，位置是否改变</span><br><span class="line">  endVal(val: number, sta: boolean) &#123; &#125;</span><br><span class="line">  @Emit(&apos;changeStart&apos;)</span><br><span class="line">  startVal(val: number) &#123; &#125;</span><br><span class="line">  created () &#123;</span><br><span class="line">  &#125;</span><br><span class="line">  mounted () &#123;</span><br><span class="line">    // 存储slider在页面的位置及大小信息</span><br><span class="line">    const slider: any = $(this.$refs.slider),</span><br><span class="line">      line: any = $(this.$refs.line)</span><br><span class="line"></span><br><span class="line">    this.sliderInfo = &#123;</span><br><span class="line">      wid: slider.width(),</span><br><span class="line">      hei: line.height(),</span><br><span class="line">      left: slider.offset().left,</span><br><span class="line">      right: slider.width() + slider.offset().left</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  destroyed () &#123;</span><br><span class="line">  &#125;</span><br><span class="line">  get lineSty() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      height: this.hei,</span><br><span class="line">      backgroundColor: this.color,</span><br><span class="line">      borderRadius: this.hei</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  get btnPosit() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      left: ((this.val / (this.maxVal - this.minVal)) * 100) + &apos;%&apos;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  get lineChooseSty() &#123;</span><br><span class="line">    let wid = ((this.val / (this.maxVal - this.minVal)) * 100) + &apos;%&apos;</span><br><span class="line"></span><br><span class="line">    return &#123;</span><br><span class="line">      width: wid,</span><br><span class="line">      height: this.hei,</span><br><span class="line">      backgroundColor: this.chooseColor</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  touchStart() &#123;</span><br><span class="line">    if(this.disabled)&#123; return &#125;</span><br><span class="line">    window.addEventListener(&apos;touchmove&apos;, this.onTouch)</span><br><span class="line">    this.startValue = this.val</span><br><span class="line">    this.startVal(this.val)</span><br><span class="line">    this.isTouch = true</span><br><span class="line">    this.showTag = true &#125;</span><br><span class="line">  touchEnd() &#123;</span><br><span class="line">    if(this.disabled)&#123; return &#125;</span><br><span class="line">    window.removeEventListener(&apos;touchmove&apos;, this.onTouch)</span><br><span class="line">    const sta = this.startValue === this.val</span><br><span class="line"></span><br><span class="line">    this.endVal(this.val, sta)</span><br><span class="line">    this.isTouch = false</span><br><span class="line">    this.showTag = false &#125;</span><br><span class="line">  onTouchFn(e) :void&#123;</span><br><span class="line">    if(!this.isTouch)&#123; return &#125;</span><br><span class="line">    const pos: number = e.targetTouches[0].pageX</span><br><span class="line"></span><br><span class="line">    if(pos &gt;= this.sliderInfo.right) &#123;</span><br><span class="line">      this.changeVal(this.maxVal)</span><br><span class="line">      return &#125;</span><br><span class="line">    else if(pos &lt;= this.sliderInfo.left) &#123;</span><br><span class="line">      this.changeVal(this.minVal)</span><br><span class="line">      return &#125;</span><br><span class="line">    else &#123;</span><br><span class="line">      const ratio: number = (pos - this.sliderInfo.left) / this.sliderInfo.wid,</span><br><span class="line">        val = this.maxVal * ratio</span><br><span class="line"></span><br><span class="line">      this.changeVal(Number(Number(val).toFixed(this.digit)))</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;stylus&quot; scoped&gt;</span><br><span class="line">@import &apos;../../static/css/common.styl&apos;</span><br><span class="line"></span><br><span class="line">// tag动画</span><br><span class="line">.tag-enter-active, .tag-leave-active</span><br><span class="line">  transition opacity .5s</span><br><span class="line">.tag-enter, .tag-leave-to</span><br><span class="line">  opacity 0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// 按钮动画</span><br><span class="line">.enter</span><br><span class="line">  animation sliderEnter .5s</span><br><span class="line">  animation-fill-mode forwards</span><br><span class="line">.out</span><br><span class="line">  animation sliderOut .5s</span><br><span class="line">  animation-fill-mode forwards</span><br><span class="line">@keyframes sliderEnter</span><br><span class="line">  0% </span><br><span class="line">    transform scale(1) translate(-50%, -50%)</span><br><span class="line">  100%</span><br><span class="line">    transform scale(1.2) translate(-50%, -50%)</span><br><span class="line">@keyframes sliderOut</span><br><span class="line">  0% </span><br><span class="line">    transform scale(1.2) translate(-50%, -50%)</span><br><span class="line">  100%</span><br><span class="line">    transform scale(1) translate(-50%, -50%)</span><br><span class="line"></span><br><span class="line">.slider-box</span><br><span class="line">  position relative</span><br><span class="line">  display flex</span><br><span class="line">  align-items center</span><br><span class="line">  height 50px</span><br><span class="line">  .slider-line</span><br><span class="line">    position absolute</span><br><span class="line">    top 50%</span><br><span class="line">    transform translateY(-50%)</span><br><span class="line">    width 100%</span><br><span class="line">  .slider-line_choose</span><br><span class="line">    position absolute</span><br><span class="line">    top 50%</span><br><span class="line">    transform translateY(-50%)</span><br><span class="line">    width 100%</span><br><span class="line">    transition all .2s ease</span><br><span class="line">  .slider-btn</span><br><span class="line">    position absolute</span><br><span class="line">    top 50%</span><br><span class="line">    vertical-align middle</span><br><span class="line">    transition all .05s ease</span><br><span class="line">    width 13px</span><br><span class="line">    height 13px</span><br><span class="line">    border 1.5px solid</span><br><span class="line">    border-radius 50%</span><br><span class="line">    background #fff</span><br><span class="line">  .slider-val</span><br><span class="line">    display none</span><br><span class="line">  .tag</span><br><span class="line">    position absolute</span><br><span class="line">    left 50%</span><br><span class="line">    transform translate(-50%, -60px)</span><br><span class="line">    padding 5px 10px</span><br><span class="line">    border-radius 5px</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
<p>文章原址：<a href="http://blog.csdn.net/qq_25243451/article/details/78664354" target="_blank" rel="noopener">http://blog.csdn.net/qq_25243451/article/details/78664354</a></p>

      
    </div>
    
    
    

    

    

    

    
      <div>
        <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;margin: 20px 0 0;">-------------正文到此结束<i class="fa fa-paw"></i>转载请注明原址-------------</div>
    
</div>
      </div>
      <div>
        
      </div>
    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Vue/" rel="tag"># Vue</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/10/13/vue2_typescript/" rel="next" title="基于Vue2+TypeScript的项目规划搭建">
                <i class="fa fa-chevron-left"></i> 基于Vue2+TypeScript的项目规划搭建
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/12/01/web/" rel="prev" title="前端常用插件，知识点汇总">
                前端常用插件，知识点汇总 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      <div id="SOHUCS"></div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.jpg"
                alt="安冉" />
            
              <p class="site-author-name" itemprop="name">安冉</p>
              <p class="site-description motion-element" itemprop="description">温佳伟的个人博客<安冉></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives">
              
                  <span class="site-state-item-count">22</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">1</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">13</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/lwpersonal" target="_blank" title="GitHub">
                      GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://www.zhihu.com/people/xue-wu-zhi-jing-9-15/activities" target="_blank" title="知乎">
                      知乎</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://www.jianshu.com/u/dc0cf2cb01f8" target="_blank" title="简书">
                      简书</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://me.csdn.net/qq_25243451" target="_blank" title="CSDN">
                      CSDN</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://segmentfault.com/u/lwpersonal" target="_blank" title="SegmentFault">
                      SegmentFault</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://juejin.im/user/58c7826744d904006808e3d4" target="_blank" title="掘金">
                      掘金</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://twitter.com/oQCXjovhhoCpBUf" target="_blank" title="Twitter">
                      Twitter</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://www.facebook.com/profile.php?id=100015842580113" target="_blank" title="FaceBook">
                      FaceBook</a>
                  </span>
                
            </div>
          

          
          

          
          

          


  <div class="">
    <span id="busuanzi_container_site_uv">
      本站总访问量&nbsp;<span id="busuanzi_value_site_pv"></span>&nbsp;次
    </span>
  </div>



  <div class="theme-info">
    <div class="powered-by"></div>
    <span class="post-count">博客全站共&nbsp;28.7k&nbsp;字</span>
  </div>


        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">安冉</span>

  
</div>








        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  




  
    <script type="text/javascript">
    (function(){
      var appid = 'cytQ99i30';
      var conf = '77eda6405b43078162120f53cb1c849f';
      var width = window.innerWidth || document.documentElement.clientWidth;
      if (width < 960) {
      window.document.write('<script id="changyan_mobile_js" charset="utf-8" type="text/javascript" src="https://changyan.sohu.com/upload/mobile/wap-js/changyan_mobile.js?client_id=' + appid + '&conf=' + conf + '"><\/script>'); } else { var loadJs=function(d,a){var c=document.getElementsByTagName("head")[0]||document.head||document.documentElement;var b=document.createElement("script");b.setAttribute("type","text/javascript");b.setAttribute("charset","UTF-8");b.setAttribute("src",d);if(typeof a==="function"){if(window.attachEvent){b.onreadystatechange=function(){var e=b.readyState;if(e==="loaded"||e==="complete"){b.onreadystatechange=null;a()}}}else{b.onload=a}}c.appendChild(b)};loadJs("https://changyan.sohu.com/upload/changyan.js",function(){
        window.changyan.api.config({appid:appid,conf:conf})});
      }
    })();
    </script>
    <!-- <script type="text/javascript" src="https://assets.changyan.sohu.com/upload/plugins/plugins.count.js"></script> -->
  









  





  

  

  

  
  

  

  

  

</body>
</html>
